<!DOCTYPE html>
<!-- saved from url=(0037)http://www.atatech.org/articles/23673 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>提交苹果的内核漏洞-CVE-2014-4369分析报告</title>
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://www.atatech.org/assets/app-714e89bf8406edd8450de0e09e22ae3766b2b9b9.css">
    <script src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/app-b6a325c0b74907fbb443fd62aca552cbf3a3619c.js" data-main="article/show"></script>
    <script>require('main')</script>
    <!--[if lt IE 9]>
    <script src="/js/html5shiv-3.7.0.min.js"></script>
    <script src="/js/respond-1.4.2.min.js"></script>
    <![endif]-->
  </head>
  <body class="">
              <header>
  <div class="navbar navbar-default">
    <div class="container">
        <ul class="nav navbar-nav">
          <li><a href="http://www.atatech.org/square/">首页</a></li>
          <li><a href="http://www.atatech.org/articles/?sort=yuan">文章</a></li>
          <li><a href="http://www.atatech.org/ask">问答</a></li>
          <li class="divider"></li>
          <li><a href="http://www.atatech.org/groups/">圈子</a></li>
          <li><a href="http://www.atatech.org/teams/">团队博客</a></li>
          <li><a href="http://www.atatech.org/rookie/">新人专区</a></li>
          <li><a href="http://www.atatech.org/databoard/" target="_blank">数据看板</a></li>
          <li><a href="http://www.atatech.org/field/security/">安全领域</a></li>
        </ul>
        <ul class="nav navbar-nav pull-right">
          <li><a href="http://www.atatech.org/notifications/">消息</a></li>
          <li><a href="http://www.atatech.org/feed/">动态</a></li>
          <li class="divider"></li>
          <li class="dropdown">
            <a href="http://www.atatech.org/users/147617#information" class="navbar-avatar" data-toggle="dropdown">
              <img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_identicon_1e4c9aea2f6c57a2d2fabfe925dad976.png_40x40" width="20" height="20" alt="英铮" class="img-circle">
              <span>&nbsp;英铮</span>
              <span class="caret"></span>
            </a>
            <ul class="dropdown-menu" role="menu">
              <li>
                <a href="http://www.atatech.org/users/147617/own#information">
                <span class="glyphicon glyphicon-edit"></span>
                <span>我的文章</span>
                </a>
              </li>
              <li>
                <a href="http://www.atatech.org/users/147617/ask#information">
                <span class="glyphicon glyphicon-question-sign"></span>
                <span>我的问题</span>
                </a>
              </li>
              <li>
                <a href="http://www.atatech.org/users/147617/mark#information">
                <span class="glyphicon glyphicon-star-empty"></span>
                <span>我的收藏</span>
                </a>
              </li>
              <li>
                <a href="http://www.atatech.org/settings/">
                <span class="glyphicon glyphicon-cog"></span>
                <span>个人设置</span>
                </a>
              </li>
                            <li class="divider"></li>
              <li>
                <a href="http://www.atatech.org/logout" data-method="post">
                <span class="glyphicon glyphicon-log-out"></span>
                <span>退出</span>
                </a>
              </li>
            </ul><!-- /.dropdown -->
          </li>
          <li class="dropdown quick-search">
            <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-search"></span></button>
            <div class="dropdown-menu form-group" role="menu">
              <form action="http://www.atatech.org/search" method="get" class="quick-form">
                    <input type="hidden" name="type" value="ARTICLE">
                    <input type="text" name="q" class="form-control" placeholder="全站搜索">
                    <button type="submit" class="quick_btn"></button>
              </form>
            </div>
          </li>
        </ul>
    </div>
  </div>
  
  </header>                <div class="container">
          </div>
        

<div class="container"><div class="_article-container">
    <div class="_article-ribbons hidden-xs">
            <div class="_article-ribbon _article-ribbon-danger">
      <span class="glyphicon glyphicon-lock"></span>
      <span class="_article-ribbon-text">内部资料请勿外传</span>
    </div>
            <div class="_article-ribbon _article-ribbon-info">
            <span class="glyphicon glyphicon-leaf"></span>
      <span class="_article-ribbon-text">作者原创</span>
    </div>
          </div>
  <div class="_article-box" role="main">
    <article class="_article">
      <header class="heading">
        <h1 class="title clearfix unsafe">
          <span class="highlight">
            提交苹果的内核漏洞-CVE-2014-4369分析报告
                      </span>
        </h1>
        <div class="infos clearfix">
          <a href="http://www.atatech.org/users/79564" class="info" title="耀刺"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_identicon_976f26e16f52c34681b9c02a07a99974.png_80x80" width="32" height="32" alt="耀刺" class="img-user"><span>&nbsp;耀刺</span></a>                    <span class="info">浏览 510</span>
          <span class="info">
                        <time class="" datetime="2014-10-11T10:12:24+08:00">2014-10-11 10:12:24</time>
          </span>
                          <span class="info">发表于：<a href="http://www.atatech.org/groups/1183">无线安全无极限</a></span>
                    
          <div class="pull-right">
                        
                        
                      </div>
        </div>

                <div class="labels">
    <form accept-charset="UTF-8" action="http://www.atatech.org/articles/23673/tags" autocomplete="off" method="post" data-remote="true" data-done="$(this).closest(&#39;.labels&#39;).replaceWith(r);$.alert(&#39;修改成功&#39;, &#39;success&#39;)" style="display:none">
    <input type="hidden" name="_method" value="put">
    <div class="form-group">
      <input type="text" name="tags" class="form-control selectized" value="ios 内核 漏洞 CVE 驱动 " tabindex="-1" style="display: none;"><div class="selectize-control form-control multi plugin-remove_button"><div class="selectize-input items not-full has-options has-items"><div data-value="ios" class="item">ios<a href="javascript:void(0)" class="remove" tabindex="-1" title="Remove">×</a></div><div data-value="内核" class="item">内核<a href="javascript:void(0)" class="remove" tabindex="-1" title="Remove">×</a></div><div data-value="漏洞" class="item">漏洞<a href="javascript:void(0)" class="remove" tabindex="-1" title="Remove">×</a></div><div data-value="CVE" class="item">CVE<a href="javascript:void(0)" class="remove" tabindex="-1" title="Remove">×</a></div><div data-value="驱动" class="item">驱动<a href="javascript:void(0)" class="remove" tabindex="-1" title="Remove">×</a></div><input type="text" autocomplete="off" tabindex="" style="width: 4px;"></div><div class="selectize-dropdown form-control multi plugin-remove_button" style="display: none;"><div class="selectize-dropdown-content"><div data-value="Java核心技术" data-selectable="" class="option active">Java核心技术</div><div data-value="Java" data-selectable="" class="option">Java</div><div data-value="架构" data-selectable="" class="option">架构</div><div data-value="前端与交互设计" data-selectable="" class="option">前端与交互设计</div><div data-value="分布式系统与计算" data-selectable="" class="option">分布式系统与计算</div><div data-value="算法" data-selectable="" class="option">算法</div><div data-value="数据存储与数据库" data-selectable="" class="option">数据存储与数据库</div><div data-value="测试技术" data-selectable="" class="option">测试技术</div><div data-value="编程语言" data-selectable="" class="option">编程语言</div></div></div></div>
    </div>
    <div class="form-group text-right">
      <button type="button" class="btn btn-default btn-sm" onclick="$(this).closest(&#39;.labels&#39;).children().toggle()">取消</button>
      <button type="submit" class="btn btn-primary btn-sm">更新</button>
    </div>
  </form>
    
  <div>
    <a href="http://www.atatech.org/search?q=ios&type=INSIDE_ARTICLE_TAG" class="label label-ata">ios</a><a href="http://www.atatech.org/search?q=%E5%86%85%E6%A0%B8&type=INSIDE_ARTICLE_TAG" class="label label-ata">内核</a><a href="http://www.atatech.org/search?q=%E6%BC%8F%E6%B4%9E&type=INSIDE_ARTICLE_TAG" class="label label-ata">漏洞</a><a href="http://www.atatech.org/search?q=CVE&type=INSIDE_ARTICLE_TAG" class="label label-ata">CVE</a><a href="http://www.atatech.org/search?q=%E9%A9%B1%E5%8A%A8&type=INSIDE_ARTICLE_TAG" class="label label-ata">驱动</a>        <button type="button" id="edit-tags" class="btn btn-default btn-xs" onclick="$(this).closest(&#39;.labels&#39;).children().toggle()">
      <span class="glyphicon glyphicon-pencil"></span>
      修改标签
    </button>
    <a href="http://www.atatech.org/articles/23673/tags/history" class="btn btn-default btn-xs" data-toggle="modal" data-target="#modal-tag-history">
      <span class="glyphicon glyphicon-time"></span>
      标签历史
    </a>
      </div>
</div>
      </header>
      
      <div class="content unsafe">
        
<pre><code data-language="" class="java hljs">   CVE-<span class="hljs-number">2014</span>-<span class="hljs-number">4369</span>是我在不久前提交给苹果的一个内核漏洞，苹果在iOS8发布的时候修复了该问题。下面是该漏洞的详细分析过程和一些有意思的发现。
</code></pre>
<h1 id="0">1.PoC</h1>
<p><a href="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/61804b604b7e869002a7563c24417ed00c7753cc" target="_blank"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/61804b604b7e869002a7563c24417ed00c7753cc" alt="image1" title="image1"></a><br><a href="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/55970422dfd913dde3d907a3820864bfe7546934" target="_blank"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/55970422dfd913dde3d907a3820864bfe7546934" alt="image2" title="image2"></a></p>
<pre><code data-language="" class="java hljs">   运行及分析环境如Panic Log所示
</code></pre>
<h1 id="1">2.分析</h1>
<pre><code data-language="" class="java hljs">   分析思路是根据输入参数定位代码在内核的执行流，找到和Panic吻合的寄存器状态（pc及其他）。
</code></pre>
<h2 id="2">2.1 Connect Server</h2>
<pre><code data-language="" class="java hljs">    PoC对应的IOService是SGXDriver535，当openType为<span class="hljs-number">0</span>对应IOUserClient是IMGSGXGLContext
    SGXDriver535继承关系为：
    SGXDriver535&lt;-IOGraphicsAccelerator&lt;-IOAcceleratorES &lt;-IOService
    IMGSGXGLContext继承关系为：
    IMGSGXGLContext&lt;-IOAccelGLContext&lt;-IOUserClient
</code></pre>
<h2 id="3">2.2 Call Selector 6</h2>
<pre><code data-language="" class="java hljs">    IMGSGXGLContext对应传入Selector=<span class="hljs-number">6</span>时候的IOExternalMethodDispatch如下：
</code></pre>
<p><a href="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/1f6357e9934911a93c8ce78edc1444c942dd1d76" target="_blank"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/1f6357e9934911a93c8ce78edc1444c942dd1d76" alt="image3" title="image3"></a></p>
<pre><code data-language="" class="java hljs">    function=sub_80A95F44，checkScalarInputCount=<span class="hljs-number">0</span>, checkStructureInputSize=<span class="hljs-number">0</span>，checkScalarOutputCount=<span class="hljs-number">0</span>，checkStructureOutputSize=<span class="hljs-number">0</span>。既然POC代码参数输入格式和苹果要求的一致，为啥调用会引起系统panic，这个悬念留到后面解答。
   再看看sub_80A95F44的实现：
</code></pre>
<p><a href="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/c5fe0e5092e6087dca2d8857c55a4d678827a1a4" target="_blank"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/c5fe0e5092e6087dca2d8857c55a4d678827a1a4" alt="image4" title="image4"></a></p>
<pre><code data-language="" class="java hljs">   相当于执行sub_8A9705C(IMGSGXGLContext*arg1,arg3-&gt; asyncReference,IOExternalMethodArguments* arg3)。sub_80A9705C，只列出关键执行部分：
</code></pre>
<p><a href="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/abf720a0b31ac2859264c5e869168b5572a632ea" target="_blank"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/abf720a0b31ac2859264c5e869168b5572a632ea" alt="image5" title="image5"></a></p>
<pre><code data-language="" class="java hljs">     A1创建了一个IOAccelBlockFencePort对象，在A2的BLX R2等价于调用IOAccelBlockFencePort的sub_80AA5890方法：
     sub_80AA5890(IOAccelBlockFencePort*, arg3-&gt; asyncReference) ，sub_80AA5890实现为：
</code></pre>
<p><a href="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/effe58da414e43c708bfc66dd17d620a7021727f" target="_blank"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/effe58da414e43c708bfc66dd17d620a7021727f" alt="image6" title="image6"></a></p>
<pre><code data-language="" class="java hljs">    R5=R1，对应arg3-&gt; asyncReference。POC使用的是同步方法，arg3-&gt; asyncReference为NULL。可以预见在LDR R0,[R5,#<span class="hljs-number">0x10</span>]会发现空指针引用，自然会panic。
   实际上开始的PanicLog PC对应的地址也正好是LDR R0,[R5,#<span class="hljs-number">0x10</span>]对应的地址，R5也是<span class="hljs-number">0</span>，其他寄存器的值也在预期内。
</code></pre>
<h1 id="4">3.最后</h1>
<pre><code data-language="" class="java hljs">   这个漏洞产生的根本原因是IMGSGXGLContext的selector <span class="hljs-number">6</span>只预期接受异步调用，到通过同步调用的时候，没有考虑到asyncReference为空的情况。
    通过这个问题显然可以得出结论：苹果没有一种测试用例是同一个接口分别尝试同步和异步调用。因此这个肯定不是一个特例，如果将所有原本在异步下执行的接口在同步下在跑一遍，应该会有不少发现。
</code></pre>

      </div>
            
      
      <div class="_article-float hidden-xs" data-fixed="false">
        <div class="container">
          <div class="_article-float-inner">
          <aside class="_article-side">
    <a href="http://www.atatech.org/articles/23673/follow" class="btn btn-primary btn-block" role="button" rel="nofollow" data-remote="true" data-method="post" data-done="$(this).parent().replaceWith(r)">关注</a>
    <section class="_article-followers">
    <h6 class="heading text-center">1人关注该文章</h6>
    <ul class="list-inline">
      <li><a href="http://www.atatech.org/users/79564" title="耀刺"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_identicon_976f26e16f52c34681b9c02a07a99974.png_80x80" width="26" height="26" alt="耀刺" class="img-user"></a></li>    </ul>
  </section>
</aside>
          </div>
        </div>
      </div>

      <footer class="actions">
        <a href="http://www.atatech.org/articles/23673#comment" class="btn btn-primary js-scroll-to">评论文章
                      (1)
                  </a>
        <a href="http://www.atatech.org/articles/23673/voteup" title="赞" class="btn btn-default" role="button" rel="nofollow" data-remote="true" data-method="post" data-done="$(this).next().addBack().toggle();$(&#39;#voters&#39;).html(r)">
          <span class="glyphicon glyphicon-thumbs-up"></span>
          20
        </a>
        <a href="http://www.atatech.org/articles/23673/unvoteup" title="取消赞" class="btn btn-primary" role="button" rel="nofollow" data-remote="true" data-method="post" data-done="$(this).prev().addBack().toggle();$(&#39;#voters&#39;).html(r)" style="display:none">
          <span class="glyphicon glyphicon-thumbs-up"></span>
          21
        </a>
                <button class="btn btn-default" data-toggle="modal" data-target="#modal-share" data-article-id="23673" data-share-count-target="#share-count" title="分享">
          <span class="glyphicon glyphicon-share"></span>
          <span id="share-count">0</span>
        </button>
                	<!-- 收藏 -->
        <a href="http://www.atatech.org/articles/23673/mark" title="收藏" class="btn btn-default" role="button" rel="nofollow" data-remote="true" data-method="post" data-done="$(this).next().addBack().toggle()">
          <span class="glyphicon glyphicon-star"></span>
          2
        </a>
        <a href="http://www.atatech.org/articles/23673/unmark" title="取消收藏" class="btn btn-primary" role="button" rel="nofollow" data-remote="true" data-done="$(this).prev().addBack().toggle()" data-method="post" style="display:none">
          <span class="glyphicon glyphicon-star"></span>
          3
        </a>
      </footer>
    </article>

    <hr>
    

    <div id="voters">
      <div id="voters" class="_article-voters">
  <h3 class="heading">他们赞过该文章</h3>
  <ul class="list-inline"><li><a href="http://www.atatech.org/users/93205" title="新霜"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_identicon_341e14ffeef1e37f0cd20b3a9e77208f.png_80x80" width="28" height="28" alt="新霜" class="img-user"></a></li><li><a href="http://www.atatech.org/users/17437" title="天孝"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_identicon_2d3bd33aee1c465d1234e70714324850.png_80x80" width="28" height="28" alt="天孝" class="img-user"></a></li><li><a href="http://www.atatech.org/users/59848" title="嗨牛"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_avatar_20140414144008_59848_60.jpeg_80x80" width="28" height="28" alt="嗨牛" class="img-user"></a></li><li><a href="http://www.atatech.org/users/101517" title="余玠"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_identicon_c7102a3eba7e40a8ef3f70846a0a0621.png_80x80" width="28" height="28" alt="余玠" class="img-user"></a></li><li><a href="http://www.atatech.org/users/94749" title="孤韧"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_identicon_c473c27dcdfc000669f1f454af18d9ec.png_80x80" width="28" height="28" alt="孤韧" class="img-user"></a></li><li><a href="http://www.atatech.org/users/101134" title="贾雅"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_identicon_958d2a6bbcd00ce34a53f6011c89df7d.png_80x80" width="28" height="28" alt="贾雅" class="img-user"></a></li><li><a href="http://www.atatech.org/users/76833" title="宏宽"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_identicon_4cfe33e2fcffb085216defa6daf9a004.png_80x80" width="28" height="28" alt="宏宽" class="img-user"></a></li><li><a href="http://www.atatech.org/users/106083" title="太高"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/img_20141008091418.jpg_80x80" width="28" height="28" alt="太高" class="img-user"></a></li><li><a href="http://www.atatech.org/users/22688" title="文泰"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_avatar_20120824134629_22688_60.jpeg_80x80" width="28" height="28" alt="文泰" class="img-user"></a></li><li><a href="http://www.atatech.org/users/22699" title="方正"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_avatar_20120719181110_22699_60.jpeg_80x80" width="28" height="28" alt="方正" class="img-user"></a></li><li><a href="http://www.atatech.org/users/102722" title="黑昼"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_identicon_eeed182fe5e6a9cf079328aaad078dee.png_80x80" width="28" height="28" alt="黑昼" class="img-user"></a></li><li><a href="http://www.atatech.org/users/82742" title="奇正"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_identicon_90ca7965d4e07e309db02504f5a5f92b.png_80x80" width="28" height="28" alt="奇正" class="img-user"></a></li><li><a href="http://www.atatech.org/users/9915" title="渐飞"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_avatar_20120719180801_9915_60.jpeg_80x80" width="28" height="28" alt="渐飞" class="img-user"></a></li><li><a href="http://www.atatech.org/users/8655" title="七戒"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_avatar_20120725183028_8655_60.jpeg_80x80" width="28" height="28" alt="七戒" class="img-user"></a></li><li><a href="http://www.atatech.org/users/70265" title="翔歌"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/img_20140905135954.png_80x80" width="28" height="28" alt="翔歌" class="img-user"></a></li><li><a href="http://www.atatech.org/users/22560" title="察罕"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_avatar_20120719181048_22560_60.jpeg_80x80" width="28" height="28" alt="察罕" class="img-user"></a></li><li><a href="http://www.atatech.org/users/15679" title="青璃"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_avatar_20120719180858_15679_60.jpeg_80x80" width="28" height="28" alt="青璃" class="img-user"></a></li><li><a href="http://www.atatech.org/users/66531" title="云翮"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_avatar_20131030151814_66531_60.jpeg_80x80" width="28" height="28" alt="云翮" class="img-user"></a></li><li><a href="http://www.atatech.org/users/34293" title="酥心"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/img_20140929110429.jpg_80x80" width="28" height="28" alt="酥心" class="img-user"></a></li><li><a href="http://www.atatech.org/users/13240" title="孟铸"><img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_avatar_20120719180823_13240_60.jpeg_80x80" width="28" height="28" alt="孟铸" class="img-user"></a></li><!-- <li><a href="#" class="img-user _article-voters-more" style="width:28px;height:28px">...</a></li> --></ul></div>
<hr>
    </div>

            <table width="100%" class="cnzz-event" id="article-recommend">
            <tbody><tr>
                <th rowspan="3" width="5%">相<br>似<br>文<br>章</th>
                <td width="50%"><li><a href="http://www.atatech.org/articles/18539">通过实现来理解`Promise/A+`规范</a></li></td>
                <td width="45%"><li><a href="http://www.atatech.org/articles/28718">android学习-intent</a></li></td>
            </tr>
                            <tr>
                    <td><li><a href="http://www.atatech.org/articles/21085">ES6 - Generator，未来，已来！</a></li></td>
                    <td><li><a href="http://www.atatech.org/articles/32123">Activity Stack 和 Task 总结</a></li></td>
                </tr>
                            <tr>
                    <td><li><a href="http://www.atatech.org/articles/19439">Generator基础篇</a></li></td>
                    <td><li><a href="http://www.atatech.org/articles/18263">回调(callback)实用一例(python）</a></li></td>
                </tr>
                    </tbody></table>
    
        <ul class="pager _article-pager">
            <li class="previous"><a href="http://www.atatech.org/articles/19071">上一篇：iOS 内核驱动分析</a></li>
                  <li class="next"><a href="http://www.atatech.org/articles/24122">下一篇：dyld漏洞介绍及利用</a></li>
          </ul>
    <hr>
    
    <section class="comments-box clearfix">
      <div class="media-list comments" id="comments">
        
<div class="comment media gaze in" id="comment-31450">
  <div class="pull-left">
    <a href="http://www.atatech.org/users/72659" class="avatar">
      <img class="media-object img-circle" src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/u_identicon_80d65ffd8012adb804f546f171fd635f.png_120x120" width="42" height="42" alt="">
    </a>
        <span style="margin-left: 10px">
        1F
    </span>
      </div>
  <div class="media-body">
    <div class="source clearfix">
      <a href="http://www.atatech.org/users/72659" class="author">义豪</a>
            <span class="pull-right small">
        <a href="http://www.atatech.org/articles/23673#comment-31450" class="link"><span class="glyphicon glyphicon-link"></span></a>
        <time class="js-relative-time" datetime="2014-10-16T19:01:06+08:00">2014-10-16 19:01:06</time>
      </span>
    </div>

    <div class="content unsafe">
      
<p>赞刨根究底的精神</p>

    </div>
    
    <div class="voters-p"></div>

    <div class="actions clearfix">
      <a href="http://www.atatech.org/comments/31450/voteup" title="赞" class="btn btn-link btn-sm action" role="button" rel="nofollow" data-remote="true" data-method="post" data-done="$(this).closest(&#39;.comment&#39;).find(&#39;.voters-p:first&#39;).replaceWith(r);$(this).hide().siblings(&#39;:hidden&#39;).show()">
        <span class="glyphicon glyphicon-thumbs-up"></span>
        0
      </a>
      <a href="http://www.atatech.org/comments/31450/unvoteup" title="取消赞" class="btn btn-link btn-sm action active" role="button" rel="nofollow" data-remote="true" data-method="post" data-done="$(this).closest(&#39;.comment&#39;).find(&#39;.voters-p:first&#39;).replaceWith(r);$(this).hide().siblings(&#39;:hidden&#39;).show()" style="display:none">
        <span class="glyphicon glyphicon-thumbs-up"></span>
        1
      </a>
      <span class="sep"></span>
      <button class="btn btn-link btn-sm action" onclick="$(&#39;#sub-comments-box-31450&#39;).toggle()">
        <span class="glyphicon glyphicon-comment"></span> 
        <span id="sub-comments-count-31450">0</span>
      </button>
      
          </div><!-- /.media-body -->
    
    <div class="sub-comments-box" id="sub-comments-box-31450" style="display:none">
      <div class="sub-comments media-list" id="comment-31450-sub">


  

</div>


<form action="http://www.atatech.org/comments/31450/subcomments/" method="POST" data-remote="true" data-target="#comment-31450-sub" data-done="$(&#39;#sub-comments-count-31450&#39;).inc()" class="sub-comment-form js-comment-create js-active-on-valid">
  <input type="hidden" name="isCheck" value="1">
    <div class="form-group">
    <textarea name="content" rows="1" class="form-control js-mention js-auto-expand" placeholder="写下你的评论…" onfocus="$(this).closest(&#39;form&#39;).addClass(&#39;active&#39;)" required=""></textarea>
  </div>
  <div class="form-group text-right actions">
    <button type="reset" class="btn btn-default btn-sm" onclick="$(this).closest(&#39;form&#39;).removeClass(&#39;active&#39;)">取消</button>
    <button type="submit" class="btn btn-primary btn-sm" disabled="">评论</button>
  </div>
</form>
    </div><!-- /.sub-comments-box -->
  </div>
  
  </div>


<div class="comment-tip">
      
    
</div>
      </div>
      <script>require('comments')</script>

      <form accept-charset="UTF-8" action="http://www.atatech.org/comments" method="POST" data-remote="true" data-target="#comments" class="js-comment-create js-active-on-valid">
        <input type="hidden" name="type" value="article">
        <input type="hidden" name="isCheck" value="1">
        <input type="hidden" name="pid" value="23673">
        <div class="form-group">
          <div class="editor">
            <div class="editor-container">
              <div class="editor-actions">
                <button type="button" class="btn btn-xs editor-action js-editor-fullscreen" data-original-title="全屏">
                  <span class="glyphicon glyphicon-fullscreen"></span>
                </button>
                <button type="button" class="btn btn-xs editor-action js-editor-preview" data-original-title="预览">
                  <span class="glyphicon glyphicon-eye-open"></span>
                </button>
                <button type="button" class="btn btn-xs editor-action js-editor-upload" data-original-title="插入图片">
                  <span class="glyphicon glyphicon-picture"></span>
                </button>
              </div><!-- /.editor-actions -->
              <textarea name="content" rows="4" class="form-control js-mention js-auto-expand editor-content" id="comment" placeholder="写下你的评论…" required=""></textarea>
            </div><!-- /.editor-container -->

            <div class="editor-preview-container">
              <div class="editor-actions">
                <button type="button" class="btn btn-xs editor-action js-editor-preview-off" data-original-title="取消预览">
                  <span class="glyphicon glyphicon-eye-close"></span>
                </button>
              </div><!-- /.editor-actions -->
              <div class="editor-preview content unsafe" data-disable-with="&lt;span class=&quot;text-muted&quot;&gt;loading...&lt;/span&gt;"></div>
            </div><!-- /.editor-preview-container -->
          </div><!-- /.editor  -->
        </div>
        <div class="form-group text-right">
          <button type="submit" class="btn btn-primary" disabled="">评论</button>          
        </div>
      </form>
    </section><!-- /.comments -->

  </div><!-- /._article-box -->
</div></div><!-- /.container -->
        <footer class="footer" role="contentinfo">
  <div class="container">
	  <p class="copyright pull-left">
	  	© 2015 阿里巴巴集团 版权所有 Copyright© 15 ATA. All rights reserved.

	    <!-- cnzz PC-->
	    <script>var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5837538'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s5.cnzz.com/stat.php%3Fid%3D5837538%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script><span id="cnzz_stat_icon_5837538"><a href="http://www.cnzz.com/stat/website.php?web_id=5837538" target="_blank" title="站长统计"><img border="0" hspace="0" vspace="0" src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/pic.gif"></a></span><script src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/stat.php" type="text/javascript"></script><script src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/core.php" charset="utf-8" type="text/javascript"></script>

	    <!-- cnzz 整站-->
	    <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1254194462'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s11.cnzz.com/stat.php%3Fid%3D1254194462%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script><span id="cnzz_stat_icon_1254194462"><a href="http://www.cnzz.com/stat/website.php?web_id=1254194462" target="_blank" title="站长统计"><img border="0" hspace="0" vspace="0" src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/pic.gif"></a></span><script src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/stat(1).php" type="text/javascript"></script><script src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/core(1).php" charset="utf-8" type="text/javascript"></script>
	    <!-- /cnzz -->
	    	  </p>
    <ul class="list-inline pull-right">
      <li><a href="http://www.atatech.org/articles/17702/" target="_blank">技术专题</a></li>
      <li><a href="http://www.atatech.org/articles/13783" target="_blank">如何玩转ATA2.0</a></li>
    </ul>
  </div>
</footer>
          <div id="modal-followers" class="modal fade" role="dialog" aria-labelledby="followers" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h4 class="modal-title">关注者</h4>
      </div>
      <div class="modal-body"></div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="submit" class="btn btn-primary">分享</button>
      </div>
    </div>
  </div>
</div><!-- /#modal-share -->  <div id="modal-share" class="modal fade" role="dialog" aria-labelledby="share" aria-hidden="true">
  <div class="modal-dialog">
    <form action="http://www.atatech.org/articles/#{id}/share" method="POST" data-remote="true" data-done="$(this).closest(&#39;.modal&#39;).modal(&#39;hide&#39;);$(&#39;#share-group-or-team&#39;).selectize({plugins: [&#39;remove_button&#39;]})[0].selectize.clear();$($(this).data(&#39;shareCountTarget&#39;)).inc();$.alert(&#39;分享成功&#39;, &#39;success&#39;)" class="js-active-on-valid" novalidate="">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h4 class="modal-title">分享</h4>
      </div>
      <div class="modal-body">
        <div class="form-group">
            <a href="https://work.alibaba-inc.com/home?publicAccount=%E5%91%A8%E6%9C%AB%E4%BA%86%EF%BC%8C%E6%8E%A8%E8%8D%90%E4%B8%80%E7%AF%87ATA%E4%B8%8A%E7%9A%84%E5%B9%B2%E8%B4%A7%E5%B8%A6%E5%9B%9E%E5%AE%B6%E5%85%85%E5%85%85%E7%94%B5%E5%90%A7%3A-%29%EF%BC%81%E6%8F%90%E4%BA%A4%E8%8B%B9%E6%9E%9C%E7%9A%84%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-CVE-2014-4369%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A%28http%3A%2F%2Fwww.atatech.org%2Farticles%2F23673%29" target="_blank">分享到阿里内外</a>
        </div>
        <div class="form-group">
            <label for="share-group">分享到我的团队/圈子</label>
                            
                        <select name="share-group-or-team[]" id="share-group-or-team" class="form-control selectized" autocomplete="off" placeholder="Groups or Teams" disabled="" tabindex="-1" style="display: none;"><option value="" selected="selected"></option></select><div class="selectize-control form-control single plugin-remove_button"><div class="selectize-input items not-full disabled locked"><input type="text" autocomplete="off" tabindex="" placeholder="没有可分享的团队或圈子" style="width: 158px;"></div><div class="selectize-dropdown form-control single plugin-remove_button" style="display: none;"><div class="selectize-dropdown-content"></div></div></div>
        </div>
        <div class="form-group">
          <label for="share-users">分享给同事</label>
          <input type="text" name="users" class="form-control js-user-complete" id="share-users" placeholder="Users" required="1">
        </div>
        <div class="form-group">
          <textarea name="content" rows="3" class="form-control" placeholder="羞羞的内容"></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="submit" class="btn btn-primary" disabled="">分享</button>
      </div>
    </div>
    </form>
  </div>
</div><!-- /#modal-share -->
<script>require('modal-share')</script>
<script>
$('#share-group-or-team').selectize({
    plugins: ['remove_button']
})[0].selectize.clear();
</script>
  <div id="modal-tag-history" class="modal fade" role="dialog" aria-labelledby="tag history" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h4 class="modal-title">标签历史</h4>
      </div>
      <div class="modal-body">      
        <p class="text-muted">Loading...</p>
      </div>
    </div>
  </div>
</div><!-- /#modal-share -->
  <div id="modal-article-modify-history" class="modal fade" role="dialog" aria-labelledby="article modify history" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h4 class="modal-title">编辑历史</h4>
      </div>
      <div class="modal-body">      
        <p class="text-muted">Loading...</p>
      </div>
    </div>
  </div>
</div><!-- /#modal-share -->
        <script data-group-id="1183" data-user-id="79564">require('module/mention')</script>  <script data-group-id="1183" data-user-id="79564">require('module/user-complete')</script>  <script>require('module/tag-complete')</script>
  <script>require('module/editor')</script>
  <script>require('module/highlight')</script>
  <script src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/swfobject_modified.js"></script>
    <script>
  var _czc = _czc || [];
  var statistics_obj = {
  "article-recommend": ["文章", "相似文章"]
  };
  $('.cnzz-event a').on('click', function(){
    var id = $(this).parents('.cnzz-event').attr('id');
  _czc.push(["_trackEvent", statistics_obj[id][0], statistics_obj[id][1], "", "", id]);
  })
  </script>
    <script>
  $('.js-video').on('click', function(){

    if ($('#taobao-online-video').length > 0)
    {
      swfobject.registerObject("taobao-online-video");
    }
    
          setTimeout(function(){
        _czc.push(["_trackEvent", '文章', "提交苹果的内核漏洞-CVE-2014-4369分析报告", "", "", 'article-23673']);
      }, 1000);
      })

  $(function(){

    $('body').append('<div id="article-outline"><div style="height:15px;"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button></div></div><style>#article-outline{display:none;min-width:140p;max-width: 200px; max-height: 350px;position:absolute;top:150px;left:-999px;border:1px solid #ccc;box-shadow:5px 5px 2px #ccc;padding: 5px 10px;background-color: #fff;overflow-y: auto;scroll-x: auto;}#article-outline ul{margin:5px 0 5px 0;padding-left:30px;font-size:12px;border-left:1px dotted #ccc;}#article-outline ul:first-child{padding-left:15px;border:none;}#article-outline li{list-style-type:decimal;margin:3px 0;}</style>')
    var jOutline = $('#article-outline');

    var jContent = $('article .content');
    var jContentHeight = jContent.height();
    jOutline.find('.close').on('click', function(){
      jOutline.hide();
    })

    updateOutline();

    var top = jOutline.offset().top;
    scrollOutline();
    $(window).on('scroll', scrollOutline);
    function scrollOutline() {
      var scrollTop = $(document).scrollTop();
      var maxTop = jContent.offset().top + jContent.height() - jOutline.height();
      if (scrollTop >= top && scrollTop <= maxTop)
      {
        jOutline.css({'position': 'fixed', 'top': 0});
      }
      else if(scrollTop < top)
      {
        jOutline.css({'position': 'absolute', 'top': '150px'});
      }
      else
      {
        jOutline.css({'position': 'absolute', 'top': maxTop+'px'});
      }

    }

    function updateOutline() {
        var arrAllHeader = jContent.find("h1,h2,h3,h4,h5,h6");
        var arrOutline = ['<ul>'];
        var header, headerText;
        var id = 0;
        var level = 0,
            lastLevel = 1;
        var levelCount = 0;
        for (var i = 0, c = arrAllHeader.length; i < c; i++) {
            header = arrAllHeader[i];
            headerText = $(header).text();

            header.setAttribute('id', id);

            level = header.tagName.match(/^h(\d)$/i)[1];
            levelCount = level - lastLevel;

            if (levelCount > 0) {
                for (var j = 0; j < levelCount; j++) {
                    arrOutline.push('<ul>');
                }
            } else if (levelCount < 0) {
                levelCount *= -1;
                for (var j = 0; j < levelCount; j++) {
                    arrOutline.push('</ul>');
                }
            };
            arrOutline.push('<li>');
            arrOutline.push('<a href="#' + id + '">' + headerText + '</a>');
            arrOutline.push('</li>');
            lastLevel = level;
            id++;
        }
        arrOutline.push('</ul>')
        if(arrOutline.length > 2){
            jOutline.append(arrOutline.join(''));
            jOutline.find('ul').each(function(i,n){
                var jThis = $(this);
                if(jThis.children('li').length === 0){
                    jThis.replaceWith(jThis.children());
                }
            });
            showOutline();
        }
        else {
            hideOutline();
        }
    }

    function showOutline() {
        var offset = jContent.offset();

        jOutline.css({
            left: offset.left + jContent.width() + 10 + 'px',
        }).show();
    }

    function hideOutline(){
        jOutline.hide();
    }
});
  </script>
  
    <a href="http://www.atatech.org/articles/23673#" class="go-top" style="display: none;"><span class="glyphicon glyphicon-arrow-up"></span></a>
<script>require('module/go-top')</script>        <a href="https://work.alibaba-inc.com/work/group/8401" target="_blank" title="为ATA2.0提供反馈" style="position:fixed;right:0;bottom:100px;" class="hidden-xs">
  <img src="./提交苹果的内核漏洞-CVE-2014-4369分析报告_files/T17D1tFrVeXXcUfo_w-30-100.png" alt="">
</a>        <script type="text/javascript">
    $('.form-submit-btn').click(function(){
      $(this).parents('form').submit();
    });
    //导航 dropdown
    (function(){
    var t;
    $('.dropdown').hover(function(){
      var that = $(this);
      that.siblings().find('.dropdown-menu').hide();
      that.children('.dropdown-menu').show();
      clearTimeout(t);
    }, function(){
      var that = $(this);
      t = setTimeout(function(){
        that.children('.dropdown-menu').hide();
      }, 500)
      
    })
    }())
    </script>
  

<div class="alert-container"></div><div id="article-outline" style="left: 1160px; display: block; position: absolute; top: 150px;"><div style="height:15px;"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button></div><ul><li><a href="http://www.atatech.org/articles/23673#0">1.PoC</a></li><li><a href="http://www.atatech.org/articles/23673#1">2.分析</a></li><ul><li><a href="http://www.atatech.org/articles/23673#2">2.1 Connect Server</a></li><li><a href="http://www.atatech.org/articles/23673#3">2.2 Call Selector 6</a></li></ul><li><a href="http://www.atatech.org/articles/23673#4">3.最后</a></li></ul></div><style>#article-outline{display:none;min-width:140p;max-width: 200px; max-height: 350px;position:absolute;top:150px;left:-999px;border:1px solid #ccc;box-shadow:5px 5px 2px #ccc;padding: 5px 10px;background-color: #fff;overflow-y: auto;scroll-x: auto;}#article-outline ul{margin:5px 0 5px 0;padding-left:30px;font-size:12px;border-left:1px dotted #ccc;}#article-outline ul:first-child{padding-left:15px;border:none;}#article-outline li{list-style-type:decimal;margin:3px 0;}</style></body></html>